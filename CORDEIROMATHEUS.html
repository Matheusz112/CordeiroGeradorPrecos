<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Produtos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            margin: 0;
        }

        .planilha {
            position: relative;
            background-color: #f9f9f9;
            border: 3px solid #000;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            margin-top: 20px;
            width: 350px;
            margin-left :-20px; /* Adicione esta linha para mover para a direita */
        }


            .planilha img.logo {
                position: absolute;
                top: 10px;
                right: 10px;
                width: 100px;
                height: auto;
                display: none;
                margin-left: 50px;
            }

        .produto {
            font-weight: bold;
            font-size: 30px;
            margin-bottom: 10px;
        }

        .info {
            font-size: 12px;
            margin-bottom: 3px;
        }

            .info i {
                margin-right: 20px;
            }

        .adicional {
            font-size: 27px;
            margin-top: 3px;
            font-weight: bold;
        }

        .preco {
            font-size: 60px;
            font-weight: bold;
            color: #000000;
            margin: 10px 0;
        }

        .content {
            margin-left: 270px;
            padding: 20px;
            flex: 1;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
            margin-top: 20px;
            color: white;
        }

            .checkbox-container input[type="checkbox"] {
                display: none; /* Esconde o checkbox padrão */
            }

        .checkbox-custom {
            width: 20px;
            height: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s ease;
            flex-shrink: 0;
        }

            .checkbox-custom i {
                display: none; /* Esconde o ícone inicialmente */
            }

        /* Estilos quando o checkbox está marcado */
        .checkbox-container input[type="checkbox"]:checked + .checkbox-custom {
            background-color: #007bff; /* Cor de fundo quando marcado */
            border-color: #007bff; /* Cor da borda quando marcado */
        }

            .checkbox-container input[type="checkbox"]:checked + .checkbox-custom i {
                display: block; /* Mostra o ícone quando marcado */
                color: white; /* Cor do ícone quando marcado */
            }


        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #1c1c1c;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            text-align: center;
            z-index: 1000;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }

            .popup .checkmark {
                display: inline-block;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                background-color: #4caf50;
                position: relative;
                animation: pop-up 0.5s ease forwards;
            }

                .popup .checkmark::before {
                    content: '';
                    position: absolute;
                    width: 15px;
                    height: 30px;
                    border-right: 5px solid white;
                    border-bottom: 5px solid white;
                    top: 10px;
                    left: 18px;
                    transform: rotate(45deg);
                }

            .popup .message {
                margin-top: 10px;
                font-size: 18px;
                color: antiquewhite;
            }

        @keyframes pop-up {
            0% {
                transform: scale(0);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .menuProdutos {
            position: absolute;
            top: 10px;
            right: 0;
            max-width: 300px;
            background-color: #007bff;
            border: 1px solid #0056b3;
            border-radius: 5px;
            padding: 5px;
            box-sizing: border-box;
            display: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            animation: fadeIn 0.3s ease-out;
        }

            .menuProdutos h3 {
                margin: 0;
                padding: 10px;
                background-color: #0056b3;
                color: white;
                border-radius: 5px 5px 0 0;
                text-align: center;
                font-size: 18px;
                animation: slideDown 0.3s ease-out;
            }

            .menuProdutos ul {
                list-style-type: none;
                padding: 0;
                margin: 0;
            }

            .menuProdutos li {
                cursor: pointer;
                padding: 10px;
                font-weight: bold;
                color: #fff;
                transition: background-color 0.2s ease-in-out;
            }

                .menuProdutos li:nth-child(even) {
                    background-color: #0069d9;
                }

                .menuProdutos li:hover {
                    background-color: #0056b3;
                }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideDown {
            from {
                transform: translateY(-10px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .popupcordeiro {
            display: none; /* Inicia escondido */
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Fundo escuro semi-transparente */
            z-index: 9999;
        }

        .popupcordeiro-content {
            width: 400px; /* Largura fixa do popup */
            height: 250px; /* Altura fixa do popup */
            background-color: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .popupcordeiro h2 {
            font-weight: bold;
            color: #333;
            margin-top: 0;
        }

        .logocordeiro {
            max-width: 100px; /* Reduzindo o tamanho da logo */
            margin-bottom: 10px; /* Espaço abaixo da logo */
            pointer-events: none; /* Desabilita eventos de mouse */
        }

        /* Estilos para o loader */
        .loader {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: inline-block;
            border-top: 4px solid #2196F3; /* Azul */
            border-right: 4px solid transparent;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
            margin-bottom: 10px; /* Espaço abaixo do loader */
        }

            .loader::after {
                content: '';
                box-sizing: border-box;
                position: absolute;
                left: 0;
                top: 0;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                border-left: 4px solid #000; /* Preto */
                border-bottom: 4px solid transparent;
                animation: rotation 0.5s linear infinite reverse;
            }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
        .delete-icon {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 20px;
            color: red;
            cursor: pointer;
        }

        .edit-icon {
            position: absolute;
            top: 50px; /* Ajuste este valor conforme necessário */
            left: 10px;
            font-size: 20px;
            color: darkseagreen;
            cursor: pointer;
        }
        .radio-label {
            display: flex;
            align-items: center;
            margin: 10px 0;
            font-size: 1.2em;
            cursor: pointer;
        }

            .radio-label input {
                display: none;
            }

        .custom-radio {
            width: 20px;
            height: 20px;
            border: 2px solid #3498db;
            border-radius: 50%;
            position: relative;
            margin-right: 4px;
            transition: all 0.3s ease;
        }

            .custom-radio:after {
                content: '';
                width: 12px;
                height: 12px;
                background: white;
                border-radius: 50%;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0);
                transition: all 0.3s ease;
            }

        input[type="radio"]:checked ~ .custom-radio:after {
            transform: translate(-50%, -50%) scale(1);
        }

        .radio-icon {
            margin-left: 10px;
            font-size: 1.2em;
            color: #3498db;
        }
        @media print {


            .delete-icon {
                display: none !important;
            }

            .edit-icon {
                display: none !important;
            }

            .menu-container {
                display: none !important;
            }

            .menus{
                display: none !important;
            }
            body {
                margin: 0;
                font-family: Arial, sans-serif;
                display: flex;
                align-items: flex-start; /* Alinha os itens ao topo */
                justify-content: center; /* Centraliza horizontalmente */
                height: 100vh; /* Altura total da viewport */
            }


            .input-container,
            .btn-container,
            .print-container {
                display: none !important;
            }

            @page {
                size: A4; /* Define o tamanho da página */
                margin: 0; /* Remove as margens padrão */
            }
        }
        .menus {
            position: fixed;
            top: 0;
            left: 0;
            width: 250px;
            height: 100%;
            background-color: #007bff;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            color: white;
            overflow-y: auto;
        }
            .menus.menu-escondido {
                transform: translateX(-250px); /* Esconde o menu movendo para a esquerda */
            }

            .menus img {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                display: block;
                margin: 0 auto 20px auto;
            }

        .form-group {
            position: relative;
            margin-bottom: 15px;
        }

            .form-group i {
                position: absolute;
                left: 10px;
                top: 50%;
                transform: translateY(-50%);
                color: white;
                font-size: 18px;
            }
        ::placeholder {
            color: #f0f8ff; /* Cor desejada para o placeholder */
        }
            .form-group input[type="text"],
            .form-group input[type="number"],
            .form-group input[type="range"],
            .form-group button {
                width: calc(70% - 30px);
                padding: 10px;
                padding-left: 40px;
                border: none;
                border-radius: 25px;
                font-size: 16px;
                outline: none;
                background-color: rgba(255, 255, 255, 0.2);
                color: white;
                transition: background-color 0.3s ease;
            }

                .form-group input[type="text"]:focus,
                .form-group input[type="number"]:focus,
                .form-group input[type="range"]:focus,
                .form-group button:focus {
                    background-color: rgba(255, 255, 255, 0.3);
                }

        .radio-label {
            display: flex;
            align-items: center;
            color: white;
            margin-bottom: 10px;
        }

            .radio-label input[type="radio"] {
                margin-right: 10px;
            }

        .radio-icon {
            margin-left: auto;
            font-size: 20px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            color: white;
            margin-bottom: 10px;
        }

            .checkbox-label input[type="checkbox"] {
                margin-right: 10px;
            }

            .checkbox-label i {
                font-size: 20px;
                margin-right: 5px;
            }

        .form-group button {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

            .form-group button:hover {
                background-color: rgba(255, 255, 255, 0.3);
            }
    </style>
</head>
<body>
    <div class="menus" id="menus">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTZEHGRJCwmfsKXT_FkmaldF_BC9m9XTLD89Q&s" alt="Logo">

        <div class="form-group">
            <i class="fas fa-tag"></i>
            <input type="text" id="produto-input" placeholder="Produto">
        </div>
        <div class="form-group">
            <i class="fas fa-calendar-alt"></i>
            <input type="text" id="data-input" placeholder="Data emitida">
        </div>
        <div class="form-group">
            <i class="fas fa-dollar-sign"></i>
            <input type="number" id="precos" value="0.0" step="0.01" min="0.01">
        </div>
        <div class="form-group">
            <i class="fas fa-search"></i>
            <input type="text" id="codigo-input" placeholder="Procurar Produto (Nome / Codigo de Barras )" oninput="preencherProduto()">
        </div>
        <div class="form-group">
            <i class="fas fa-tint"></i>
            <input type="text" id="preco-litro-input" placeholder="Quantidade ML / Litro">
        </div>
        <div class="form-group">
            <i class="fas fa-arrows-alt-h"></i>
            <input type="range" id="tamanho-slider" min="200" max="800" class="range-input" oninput="ajustarLargura(this.value)">
        </div>
        <label class="radio-label">
            <input type="radio" name="opcao" value="6">
            <span class="custom-radio"></span>
            Fardo de 6uni
            <span class="radio-icon">📦</span>
        </label>
        <label class="radio-label">
            <input type="radio" name="opcao" value="12">
            <span class="custom-radio"></span>
            Fardo de 12uni
            <span class="radio-icon">📦</span>
        </label>
        <div class="checkbox-label">
            <i class="fas fa-image"></i>
            <label for="logo-checkbox">Com Logo</label>
            <input type="checkbox" id="logo-checkbox">
        </div>
        <div class="form-group">
            <button type="button" id="btnImprimir"><i class="fas fa-print"></i> Imprimir</button>
        </div>
        <div class="form-group">
            <button type="button" id="btnExcluir"><i class="fas fa-trash-alt"></i> Excluir</button>
        </div>
        <div class="form-group">
            <button type="button" id="btnBuscar" onclick="carregarDados()"><i class="fas fa-database"></i> Buscar</button>
        </div>
        <div class="form-group">
            <button type="button" id="btnAdicionar"><i class="fas fa-plus"></i> Adicionar</button>
        </div>
    </div>

    <div class="content">
        <div id="planilhas">
            <div class="planilha" id="planilha">
                <img src="C:/Users/Artur/Downloads/BAIXE NOSSO APLICATIVO SCANEANDO O QR CODE.png" class="logo" id="logo-imagem" alt="Logo">
                <div class="produto" id="produto-nome">Produto A</div>
                <div class="info"><i class=""></i><span class="preco" id="preco">R$ 19,99</span></div>
                <div class="adicional"><span id="preco-por-litro">1 LITRO SAI POR R$ 00,99</span></div>
                <div class="info"><i class="fas fa-calendar-alt"></i><span id="data-emitida">Data emitida: DD/MM/AAAA</span></div>
            </div>
        </div>
    </div>
    <div id="popupcordeiro" class="popupcordeiro">
        <div class="popupcordeiro-content">
            <img src="https://is5-ssl.mzstatic.com/image/thumb/Purple126/v4/66/60/90/666090de-4f6d-35c5-9f83-cbbcdc290738/source/256x256bb.jpg" alt="Logo" class="logocordeiro">
            <h2 id="popup-message">Carregando dados necessários...</h2>
            <span class="loader"></span>
        </div>
    </div>
    <div class="popup" id="popup">
        <div class="checkmark"></div>
        <div class="message">Preços limpos com sucesso</div>
    </div>
    <div class="menuProdutos" id="menuProdutos">
        <h3>PRODUTOS SIMILARES</h3>
        <ul id="sugestoes"></ul>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        document.getElementById('btnImprimir').addEventListener('click', function () {
            // Ação quando o botão Imprimir for clicado
            imprimirTabelas();
            // Adicione aqui a lógica para imprimir
        });

        document.getElementById('btnExcluir').addEventListener('click', function () {
            // Ação quando o botão Excluir for clicado
            console.log('Botão Excluir clicado!');
            // Adicione aqui a lógica para excluir
        });

        document.getElementById('btnBuscar').addEventListener('click', function () {

        });

        document.getElementById('btnAdicionar').addEventListener('click', function () {
            // Ação quando o botão Adicionar for clicado
            adicionarTabela();
            // Adicione aqui a lógica para adicionar produto
        });

        const produtos = {


            '0000078936683': 'CERVE HEINEKEN LN 6X330ml',
            '7891991015462': 'CERVE STELLA ARTOIS LN 6X330ml',
            '7501064113086': 'CERVE LANGER CORONA LN 6X330ml',
            '7891991298421': 'CERVE LANGER BUDWEISER LN 6X330ml',
            '7896045506040': 'CERVE HEINEKEN ZERO ÁLCOOL LN 6X330ml',
            '7891991297493 ': 'CERVE SPATEM LN 6X355ml',
            '7891149104932 ': 'CERVE BRAHMA ZERO ÁLCOOL 12X350ml',
            '7896045506064 ': 'CERVE HEINEKEN  ZERO ÁLCOOL 12X350ml',
            '7896051111016': 'LEITE ITAMBÊ INTEGRAL 12X1L',
            '7896051111702': 'LEITE ITAMBÊ DESNATADO 12X1L',
            '7896051111528': 'LEITE ITAMBÊ SEMIDESNATADO 12X1L',
            '7896122305207': 'LEITE PORTO ALEGRE INTEGRAL 12X1L',
            '7896183202187': 'LEITE QUATA INTEGRAL 12X1L',

            '7898367983356': 'CERVEJA EISENBAHN 12X473ml',
            '7896036090855': 'Óleo de Soja Veleiro 6X900ml',
            '7896036090244': 'Óleo de Soja Liza 6X900ml',
            '7896045505340': 'CERVEJA AMSTEL 12X473ml',
            '7896045506248': 'CERVEJA  HEINEKEN 12X473ml',
            '7896045503414': 'CERVEJA KAISER 12X473ml',
            '7891991009164': 'CERVEJA ANTARTICA 12X473ml',
            '7891991009222': 'CERVEJA ANTARTICA ORIGINAL 12X473ml',
            '7891149011001': 'CERVEJA BRAHMA 12X473ml',
            '7891991303323': 'CERVEJA STELLA ARTOIS 12X473ml',
            '7891991014236': 'CERVEJA BOHEMIA 473ml',
            '7891991303217': 'CERVEJA SPATEM 473ml',
            '07891991010153': 'CERVEJA ANTARTICA SUB ZERO 473ml',
            '7898215151708': 'LEITE PIRACANJUBA INTEGRAL 12X1L',
            '7896447500462': 'ÁGUA  IGARAPÉ SEM GÁS 12X500ml',
            '7896447500363': 'ÁGUA IGARAPÉ COM GÁS 12X500ml',
            '0000078908901': 'REF COCA COLA MINI PET 12X200ml',
            '7800660636419': 'REF SUKITA LARANJA PET 12X200ml',
            '07891991014984': 'REF SODA LIMONADA PET 12X200ml',
            '7891991014908': 'REF  GUARANÁ ANTARTICA PET 12X200ml',
            '7891991016124': 'REF  GUARANÁ ZERO PET 12X200ml',
            '7892840800567': 'REF PEPSI PET 12X200ml'


        };


        const produtoInput = document.getElementById('produto-input');
        const dataInput = document.getElementById('data-input');
        const precoInput = document.getElementById('preco-input');
        const codigoInput = document.getElementById('codigo-input');

        const tamanhoSlider = document.getElementById('tamanho-slider');
        const logoCheckbox = document.getElementById('logo-checkbox');

        function preencherProduto() {
            const codigoBarras = codigoInput.value;


            const mlInput = document.getElementById('preco-litro-input');
            const termo = document.getElementById('codigo-input').value.trim().toLowerCase();
            const sugestoes = document.getElementById('sugestoes');
            const menuProdutos = document.getElementById('menuProdutos');
            sugestoes.innerHTML = '';

            if (termo === '') {
                menuProdutos.style.display = 'none';
                return;
            }

            const produtosSugeridos = Object.keys(produtos).filter(codigo => {
                const nomeProduto = produtos[codigo].toLowerCase();
                return codigo.startsWith(termo) || nomeProduto.includes(termo);
            });

            if (produtosSugeridos.length === 0) {
                menuProdutos.style.display = 'none';
                return;
            }

            menuProdutos.style.display = 'block';
            produtosSugeridos.forEach(codigo => {
                const li = document.createElement('li');
                li.textContent = produtos[codigo];
                li.onclick = () => {
                    document.getElementById('codigo-input').value = codigo;
                    document.getElementById('produto-input').value = produtos[codigo];
                    menuProdutos.style.display = 'none';
                    const match = produtos[codigo].match(/(\d+)(ml|L)/i);  // Corrigido para produtos[codigo]
                    if (match) {
                        mlInput.value = match[1];
                    } else {
                        mlInput.value = '';
                    }
                    const quantidadeMatch = produtos[codigo].match(/(\d+)X/i);
                    if (quantidadeMatch) {
                        const quantidade = parseInt(quantidadeMatch[1], 10);
                        if (quantidade === 6) {
                            document.querySelector('input[name="opcao"][value="6"]').checked = true;
                        } else if (quantidade === 12) {
                            document.querySelector('input[name="opcao"][value="12"]').checked = true;
                        }
                    }
                };
                sugestoes.appendChild(li);
            });


        }
        function adicionarTabela() {
            const radios = document.querySelectorAll('input[name="opcao"]');
            let valorSelecionado = 0;

            for (const radio of radios) {
                if (radio.checked) {
                    valorSelecionado = parseFloat(radio.value);
                    break;
                }
            }

            const produtoInput = document.getElementById('produto-input').value || "Produto";
            const dataInput = document.getElementById('data-input').value || "DD/MM/AAAA";
            const precoInput = document.getElementById('precos').value;
            const preco = parseFloat(precoInput.replace(',', '.')); // Convertendo vírgula para ponto, se necessário

            const codigoInput = document.getElementById('codigo-input').value || "123456789012";
            const precoLitroInput = document.getElementById('preco-litro-input').value.replace(',', '.') || "00.99";
            const logoCheckbox = document.getElementById('logo-checkbox').checked;

            let soma = (preco / parseFloat(precoLitroInput)) * 1000;

            if (produtoInput.toLowerCase().includes('leite')) {
                soma /= 1000; // Divide por 1000 para obter o valor desejado
            }

            const total = preco * valorSelecionado;

            const planilhaContainer = document.getElementById('planilhas');
            const novaPlanilha = document.createElement('div');

            novaPlanilha.classList.add('planilha');
            novaPlanilha.innerHTML = `
                        <i class="fas fa-times-circle delete-icon" onclick="excluirTabela(this)"></i>
                        <i class="fas fa-edit edit-icon" onclick="editarTabela(this)"></i>
                        <img src="https://i.imgur.com/tIxuIE3.png" class="logo" id="logo-imagem" alt="Logo" style="display: ${logoCheckbox ? 'block' : 'none'}; width: 200px; height: 190px; margin-left: 10px;">

                        <div class="produto" id="produto-nome">${produtoInput}</div>
                        <div class="info">
                            <span class="preco">R$ ${total.toFixed(2).replace('.', ',')}</span>
                        </div>
                        <div class="adicional">
                            <span id="preco-por-litro">1 LITRO SAI POR R$ ${soma.toFixed(2).replace('.', ',')}</span>
                            <div class="info">
                                <i class="fas fa-calendar-alt"></i>
                                <span id="data-emitida">Data emitida: ${dataInput}</span>
                            </div>
                        </div>
                    `;
            planilhaContainer.appendChild(novaPlanilha);
        }

        tamanhoSlider.addEventListener('input', function () {
            const planilhas = document.querySelectorAll('.planilha');
            planilhas.forEach(planilha => {
                planilha.style.width = this.value * 2 + 'px';
            });
        });

        function imprimirTabelas() {
           
            
            document.getElementById('planilhas').style.marginLeft = '-200px';

            window.print();

            setTimeout(() => {
                // Após a impressão ou cancelamento, restaura o menu
           
                document.getElementById('planilhas').style.marginLeft = '-10px';
            }, 300);

        }

        

        document.addEventListener('DOMContentLoaded', function () {
            const today = new Date();
            const day = today.getDate().toString().padStart(2, '0');
            const month = (today.getMonth() + 1).toString().padStart(2, '0');
            const year = today.getFullYear();
            const formattedDate = `${day}/${month}/${year}`;
            dataInput.value = formattedDate;
            setTimeout(function () {
                const today = new Date();
                const day = today.getDate().toString().padStart(2, '0');
                const month = (today.getMonth() + 1).toString().padStart(2, '0');
                const year = today.getFullYear();
                const formattedDate = `${day}/${month}/${year}`;
                dataInput.value = formattedDate;
                alert("Data carregou?");
            }, 200);
        });
        function excluirTabela(element) {
            const planilha = element.closest('.planilha');
            if (planilha) {
                planilha.remove();
            }
        }
        function carregarDados() {

            axios({
                method: "GET",
                url: "https://api.baserow.io/api/database/rows/table/316133/?user_field_names=true",
                headers: {
                    Authorization: "Token UkqZsuMMnwE59fMqs8OwXX60SASP7FOd"
                }
            })
                .then(response => {
                    const dados = response.data.results;
                    resultadosComPreco = dados.filter(item => item.Preço !== "");

                    const planilhaContainer = document.getElementById('planilhas');
                    const today = new Date();
                    const day = today.getDate().toString().padStart(2, '0');
                    const month = (today.getMonth() + 1).toString().padStart(2, '0');
                    const year = today.getFullYear();
                    const formattedDate = `${day}/${month}/${year}`;
                    dataInput.value = formattedDate;

                    let somaTotal = 0;

                    resultadosComPreco.forEach(item => {
                        const precoTotal = item.Preço * item.quantidade;
                        somaTotal += precoTotal;

                        let prelitro = item.Preço / item.ML * 1000;
                        if (item.Produto.toLowerCase().includes('leite')) {
                            prelitro /= 1000; // Divide por 1000 para obter o valor desejado
                        }

                        const novaPlanilha = document.createElement('div');
                        novaPlanilha.classList.add('planilha');
                        novaPlanilha.innerHTML = `
                                    <i class="fas fa-times-circle delete-icon" onclick="excluirTabela(this)"></i>
                                    <img src="https://i.imgur.com/tIxuIE3.png" class="logo" id="logo-imagem" alt="Logo" style="display: ${logoCheckbox ? 'block' : 'none'}; width: 200px; height: 190px; margin-left: 10px;">

                                    <div class="produto" id="produto-nome">${item.Produto}</div>

                                    <div class="info">
                                        <span class="preco">R$ ${precoTotal.toFixed(2).replace(/\./g, ',')}</span>
                                    </div>

                                    <div class="adicional">
                                        <span id="preco-por-litro">1 LITRO SAI POR R$ ${prelitro.toFixed(2)}</span>
                                        <div class="info">
                                            <i class="fas fa-calendar-alt"></i>
                                            <span id="data-emitida">Data emitida: ${formattedDate}</span>
                                        </div>
                                    </div>
                                `;

                        planilhaContainer.appendChild(novaPlanilha);
                    });

                    // Exibir soma total dos preços
                    const somaTotalElement = document.createElement('div');


                    planilhaContainer.appendChild(somaTotalElement);
                })
                .catch(error => {
                    console.error('Erro ao buscar dados:', error);
                });
        }




        function limparPrecos() {

            resultadosComPreco.forEach(item => {
                axios({
                    method: "PATCH",
                    url: `https://api.baserow.io/api/database/rows/table/316133/${item.id}/?user_field_names=true`,
                    headers: {
                        Authorization: "Token UkqZsuMMnwE59fMqs8OwXX60SASP7FOd",
                        "Content-Type": "application/json"
                    },
                    data: {
                        "Preço": ""
                    }
                })
                    .then(response => {
                        console.log(`Preço do produto ${item.Produto} limpo com sucesso`);
                        alert("Banco de dados limpo com sucesso!")
                    })
                    .catch(error => {
                        console.error(`Erro ao limpar preço do produto ${item.Produto}:`, error);
                    });
            });

            // Recarregar dados após limpar os preços

        }


        function editarTabela(element) {
            const planilha = element.closest('.planilha');
            const produtoNome = planilha.querySelector('#produto-nome');
            const preco = planilha.querySelector('.preco');
            const precoPorLitro = planilha.querySelector('#preco-por-litro');

            const novoProdutoNome = prompt('Editar Nome do Produto:', produtoNome.innerText);
            if (novoProdutoNome !== null) {
                produtoNome.innerText = novoProdutoNome;
            }

            const novoPreco = prompt('Editar Preço:', preco.innerText.replace('R$ ', '').replace(',', '.'));
            if (novoPreco !== null && !isNaN(novoPreco)) {
                const novoTotal = parseFloat(novoPreco).toFixed(2).replace('.', ',');
                preco.innerText = `R$ ${novoTotal}`;

                const precoLitro = prompt('Editar Preço por Litro:', precoPorLitro.innerText.split(' ')[4].replace(',', '.'));
                if (precoLitro !== null && !isNaN(precoLitro)) {
                    const novoPrecoPorLitro = (parseFloat(novoPreco) / parseFloat(precoLitro) * 1000).toFixed(2).replace('.', ',');
                    precoPorLitro.innerText = `1 LITRO SAI POR R$ ${novoPrecoPorLitro}`;
                }
            }
        }
        // Mensagens alternadas de carregamento
        var messages = [
            "Carregando dados necessários...",
            "Por favor, aguarde um momento...",
            "Preparando o site para você...",
            "Carregando recursos...",
            "Quase lá...",
            "Finalizando carregamento..."
        ];
        var messageIndex = 0;

        // Função para alternar as mensagens
        function alternarMensagem() {
            document.getElementById('popup-message').textContent = messages[messageIndex];
            messageIndex = (messageIndex + 1) % messages.length; // Avança para a próxima mensagem
        }

        // Simula o carregamento dos dados
        function carregarDadoss() {

            var loader = document.querySelector('.loader');
            var interval = setInterval(function () {
                alternarMensagem(); // Alterna as mensagens
            }, 1000); // Tempo para alternar as mensagens (2 segundos)

            setTimeout(function () {
                clearInterval(interval);

                document.getElementById('popupcordeiro').style.display = 'none'; // Esconde o popup ao completar o carregamento
            }, 6000); // Tempo total do carregamento simulado (10 segundos)
        }

        // Mostra o popup ao carregar a página
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('popupcordeiro').style.display = 'flex'; // Exibe o popup ao iniciar
            carregarDadoss(); // Inicia o carregamento dos dados

        });



    </script>
</body>
</html>
